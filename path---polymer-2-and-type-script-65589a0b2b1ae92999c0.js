webpackJsonp([0x7eb185819e62],{644:function(e,t){e.exports={data:{markdownRemark:{html:'<p>For <a href="../polymer-2-and-redux/">reasons beyond my control</a> I\'m working with\nPolymer 2 at the moment. Although the idea of web components is great, the choice for HTML imports that comes with\nPolymer 2 makes integration into a modern development stack cumbersome, as will become clear soon. Also, HTML\nimports are not widely supported by browsers and although polyfills exist, only <a href="https://caniuse.com/#search=html%20imports">Chrome (surprise!)</a>\nwill have native support for the foreseeable future.</p>\n<p>Using TypeScript seems like a good choice, because static typing helps prevent runtime errors. Additionally it would be a\ngood opportunity to try out the <a href="https://github.com/code-star/scala-ts-interfaces">Scala-TS-interfaces project</a> by my\ncolleagues, that can generate TypeScript from a Scala domain model. Unfortunately, adding TypeScript to a Polymer 2\ndevelopment stack proves to be difficult, whereas using it with Polymer 3 seems trivial. Polymer 3 is currently in\npreview so it is not a viable option for me for the moment, but it will exchange HTML imports for ES6 Modules. This will\nmake integrating it into a modern development stack much easier. An <a href="https://github.com/mdvanes/polymer3-typescript">example</a>\nalready exists, by <a href="https://github.com/pferretti">Paolo Ferretti</a> and follows normal conventions for a TypeScript project.</p>\n<p>If you\'re adventurous, don\'t need any <a href="https://www.webcomponents.org/">existing Polymer 2 elements</a> and don\'t need to\nrun production; stop reading here and use Polymer 3.\nIf you need Polymer 2 read on, but be warned that it won\'t be pretty.</p>\n<p><strong>TL;DR to use TypeScript with Polymer 2 use <a href="https://github.com/mdvanes/typescript-batch-compiler">typescript-batch-compiler</a> or even better <a href="https://github.com/Draccoz/twc">twc</a>.</strong></p>\n<h2 id="webpack"><a href="#webpack" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Webpack</h2>\n<p>For this experiment I will use my existing Polygram project and the result will be available in the <a href="https://github.com/mdvanes/polygram/tree/TypeScript">TypeScript branch</a>. </p>\n<p>The first challenge is to use Webpack with Polymer 2. Although not strictly necessary for TypeScript compilation, it would\nmake sense for importing HTML as modules. Fortunately, <a href="https://www.youtube.com/playlist?list=PLOU2XLYxmsII5c3Mgw6fNYCzaWrsM3sMN">Rob Dodson himself</a> wrote an\narticle <a href="http://robdodson.me/how-to-use-polymer-with-webpack/">How to use Polymer with Webpack</a>. It even mentions TypeScript!\nThe article introduces the Webpack loader <a href="https://github.com/webpack-contrib/polymer-webpack-loader">https://github.com/webpack-contrib/polymer-webpack-loader</a> and\nexplains how it extracts the JavaScript from the HTML of Polymer elements and eventually packages everything into one\nJavaScript file. I was basically able to copy the webpack.config.js and index.ejs from his demo project, place it into Polygram and that would compile. I moved my\n<a href="https://github.com/mdvanes/polygram/tree/TypeScript">custom elements</a> from the root of the project to the src dir and I had\nto modify the paths to the bower_components and it would basically work. </p>\n<p>The most important exception is Redux, the redux-mixin.html can\'t resolve the PolymerRedux.html dependency (in bower_components/polymer-redux/polymer-redux.html).\nThe polymer-webpack-loader should resolve this, but runtime it logs <code class="language-text">Uncaught ReferenceError: PolymerRedux is not defined</code>.\nE.g. for src/polygram-app.html, the loader seems to import the HTML elements that are used in the <code class="language-text">template</code> element,\nbut not the JavaScript variables that are used in the <code class="language-text">script</code> element.</p>\n<p>The PolymerRedux code is distributed as JavaScript wrapped in a <code class="language-text">script</code> tag in mainly one file, so it would be easy to\nextract it to a JavaScript file. Or even to import <code class="language-text">polymer-redux/src/index.js</code> instead of <code class="language-text">polymer-redux/polymer-redux.html</code>\n(although index.js is uncompiled and misses external dependencies that are not installed in bower_components because they are development dependencies of polymer-redux).\nFor now, I just comment out the Redux dependencies.</p>\n<p>It is already clear now that the result from Webpack will be one huge bundle.js that inlines all JavaScript and HTML\ndependencies. This means using the <a href="https://www.polymer-project.org/2.0/toolbox/prpl">PRPL pattern</a> will not be possible\nin this workflow, nor will it be possible to have standalone Polymer components and the accompanying Polymer demo pages.</p>\n<h2 id="adding-ts-loader"><a href="#adding-ts-loader" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding ts-loader</h2>\n<p>Normally, to migrate a Webpack project from JavaScript to TypeScript, it would be enough to add the <a href="https://github.com/TypeStrong/ts-loader">ts-loader</a>\nto the Webpack config and to rename the JavaScript files to TypeScript files. </p>\n<p>So I started with changing the extension for the bootstrapping index.js and adding .ts as a resolved extension:</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\n<span class="token operator">...</span>\nentry<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">\'src/index.ts\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token operator">...</span>\nresolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'.ts\'</span><span class="token punctuation">,</span> <span class="token string">\'.js\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n<span class="token operator">...</span></code></pre>\n      </div>\n<p>And adding this rule:</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\n<span class="token punctuation">{</span>\n    test<span class="token punctuation">:</span> <span class="token regex">/\\.ts?$/</span><span class="token punctuation">,</span>\n    use<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n        <span class="token punctuation">{</span> loader<span class="token punctuation">:</span> <span class="token string">\'ts-loader\'</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p>And creating a tsconfig.json:</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>\n  <span class="token string">"compilerOptions"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">"sourceMap"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p>Everything still compiles, but the JavaScript for the Polymer components is embedded in the HTML and therefore ignored\nby the new rule with the ts-loader.</p>\n<p>Adding the ts-loader to the rule for the HTML files breaks compilation:</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\n<span class="token punctuation">{</span>\n    test<span class="token punctuation">:</span> <span class="token regex">/\\.html$/</span><span class="token punctuation">,</span>\n    use<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n        <span class="token punctuation">{</span> loader<span class="token punctuation">:</span> <span class="token string">\'babel-loader\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        <span class="token punctuation">{</span> loader<span class="token punctuation">:</span> <span class="token string">\'ts-loader\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// &lt;--</span>\n        <span class="token punctuation">{</span> loader<span class="token punctuation">:</span> <span class="token string">\'polymer-webpack-loader\'</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre>\n      </div>\n<p>Even without changing any of the code itself, compilation fails with:</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">ERROR in ./src/polygram-app.html\nModule build failed: Error: Could not find file: &#39;/home/me/polygram/src/polygram-app.html&#39;.</code></pre>\n      </div>\n<p>Well, that just doesn\'t look healthy. I filed <a href="https://github.com/webpack-contrib/polymer-webpack-loader/issues/64">a bug</a>\nand almost 2 months after my report the maintainers closed the issue commenting that the root cause is with Webpack, so I\ndon\'t see this will be resolved any time soon.</p>\n<p>For now, I will try to work around it by extracting the TypeScript code to a separate file. </p>\n<h3 id="workaround-for-typescript-compilation-in-a-polymer-element"><a href="#workaround-for-typescript-compilation-in-a-polymer-element" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Workaround for TypeScript compilation in a Polymer element</h3>\n<p>After removing the <code class="language-text">ts-loader</code> line from the HTML rule in the webpack.config.js I set out to extract the TypeScript to a\nseparate file so it can be compiled with the rule that matches ts files. </p>\n<p>Roughly, the main entry point for the Polymer elements <code class="language-text">polygram-app.html</code> contains:</p>\n<div class="gatsby-highlight">\n      <pre class="language-html"><code class="language-html">// imports\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>import<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../bower_components/polymer/polymer-element.html<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n...\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>import<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>polygram-details.html<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>import<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>polygram-searchbox.html<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dom-module</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>polygram-app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>\n        <span class="token comment">&lt;!-- Style --></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">include</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>iron-flex iron-flex-alignment<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style language-css"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>\n\n        <span class="token comment">&lt;!-- Markup --></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layout vertical<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            ...\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n        ...\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">\n        <span class="token comment">// Script</span>\n        <span class="token keyword">import</span> format <span class="token keyword">from</span> <span class="token string">\'date-fns/format\'</span><span class="token punctuation">;</span>\n\n        <span class="token keyword">class</span> <span class="token class-name">PolygramApp</span> <span class="token keyword">extends</span> <span class="token class-name">Polymer<span class="token punctuation">.</span>Element</span> <span class="token punctuation">{</span>\n            <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">is</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">\'polygram-app\'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>\n            <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                <span class="token keyword">return</span> <span class="token punctuation">{</span>\n                    today<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n                        type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n                        value<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                            <span class="token keyword">return</span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">\'MM/DD/YYYY\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                        <span class="token punctuation">}</span>\n                    <span class="token punctuation">}</span>\n                <span class="token punctuation">}</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n        window<span class="token punctuation">.</span>customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span>PolygramApp<span class="token punctuation">.</span>is<span class="token punctuation">,</span> PolygramApp<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dom-module</span><span class="token punctuation">></span></span></code></pre>\n      </div>\n<p>Since I know the <code class="language-text">import</code> statement in the script tag works, I can use this to my advantage. Lets create a companion\nTypeScript file for polygram-app.html named PolygramApp.ts.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token comment">// PolygramApp.ts</span>\n<span class="token keyword">import</span> format <span class="token keyword">from</span> <span class="token string">\'date-fns/format\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">PolygramApp</span> <span class="token keyword">extends</span> <span class="token class-name">Polymer<span class="token punctuation">.</span>Element</span> <span class="token punctuation">{</span>\n    <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">is</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">\'polygram-app\'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token punctuation">{</span>\n            today<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n                <span class="token keyword">type</span><span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n                value<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                    <span class="token keyword">return</span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">\'MM/DD/YYYY\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token punctuation">}</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p>It would be possible to import PolygramApp.ts with <code class="language-text">&lt;script src=&quot;PolygramApp.ts&quot;&gt;&lt;/script</code>, but I like the standard ES6 module structure\nof PolygramApp.ts without the added responsibility of registering itself to customElements, so I import it like this:</p>\n<div class="gatsby-highlight">\n      <pre class="language-html"><code class="language-html"><span class="token comment">&lt;!-- polygram-app.html --></span>\n...\n\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dom-module</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>polygram-app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    ...\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">\n        <span class="token comment">// Script</span>\n        <span class="token keyword">import</span> PolygramApp <span class="token keyword">from</span> <span class="token string">\'./polygramApp\'</span><span class="token punctuation">;</span>\n        window<span class="token punctuation">.</span>customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span>PolygramApp<span class="token punctuation">.</span>is<span class="token punctuation">,</span> PolygramApp<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dom-module</span><span class="token punctuation">></span></span></code></pre>\n      </div>\n<p>The result is a failed compilation with 3 types of errors. Let\'s deal with them one by one.</p>\n<h3 id="1-failing-accessors"><a href="#1-failing-accessors" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Failing accessors</h3>\n<p>The <code class="language-text">is</code> and <code class="language-text">properties</code> getters require a specifically set target ECMAScript version, the compilation error is:\n<code class="language-text">error TS1056: Accessors are only available when targeting ECMAScript 5 and higher</code>. It surprises me that the default\nES target is ES3, but it\'s not a problem to use ES5 or even ESNext here, because the babel-loader will transpile it back to ES5.</p>\n<p>Adding <code class="language-text">&quot;target&quot;: &quot;ESNext&quot;</code> to compilerOptions in the tsconfig.json fixes this error.</p>\n<h3 id="2-failing-polymer-import"><a href="#2-failing-polymer-import" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Failing Polymer import</h3>\n<p><code class="language-text">Polymer</code> can\'t be found for the <code class="language-text">extends</code>. This is the most difficult of these errors to solve, because it is caused by the preferred module\narchitecture of Polymer 2: because HTML imports are used, it is not possible to use <code class="language-text">import Polymer from &#39;../bower_components/polymer/polymer-element.html&#39;</code>\nbecause this polymer-element does not export <code class="language-text">Polymer</code> as an ES6 module. The webpack-polymer-loader can resolve HTML\nimports, but using <code class="language-text">import &#39;../bower_components/polymer/polymer-element.html&#39;</code> results in an <code class="language-text">error TS2304: Cannot find name &#39;Polymer&#39;</code>.</p>\n<p>For the moment, I\'m just removing the <code class="language-text">extends Polymer.Element</code> from PolygramApps.ts and <code class="language-text">window.customElements.define(PolygramApp.is, PolygramApp);</code> from polygram-app.html.</p>\n<h3 id="3-failing-date-fns-import"><a href="#3-failing-date-fns-import" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Failing date-fns import</h3>\n<p>To be able to continue resolving the compilation errors, I add a log statement to polygram-app.html:</p>\n<div class="gatsby-highlight">\n      <pre class="language-html"><code class="language-html"><span class="token comment">&lt;!-- polygram-app.html --></span>\n...\n\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dom-module</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>polygram-app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    ...\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">\n        <span class="token comment">// Script</span>\n        <span class="token keyword">import</span> PolygramApp <span class="token keyword">from</span> <span class="token string">\'./polygramApp\'</span><span class="token punctuation">;</span>\n        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>PolygramApp<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>today<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dom-module</span><span class="token punctuation">></span></span></code></pre>\n      </div>\n<p>The import of date-fns originally failed in the TypeScript compilation with\n<code class="language-text">error TS1192: Module &#39;&#39;date-fns/format&#39;&#39; has no default export.</code> but at this point that has two different behaviors:</p>\n<ul>\n<li>The IDE warns <code class="language-text">TS2307 Cannot find module date-fns</code></li>\n<li>Compilation succeeds, but this error is logged in the browser: <code class="language-text">Uncaught TypeError: format_1.default is not a function(…)</code></li>\n</ul>\n<p>I first thought that this was caused by missing typings for the date-fns library, so I tried\n<code class="language-text">npm install @types/date-fns</code> but this logs that date-fns actually provides typings.</p>\n<p>Eventually I was able to fix the Uncaught TypeError by changing the import in PolygramApp.ts from</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> format <span class="token keyword">from</span> <span class="token string">\'date-fns/format\'</span><span class="token punctuation">;</span></code></pre>\n      </div>\n<p>to</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> format <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'date-fns\'</span><span class="token punctuation">;</span></code></pre>\n      </div>\n<p>And the IDE warning by adding <code class="language-text">&quot;moduleResolution&quot;: &quot;node&quot;</code> to the compilerOptions in tsconfig.json.</p>\n<p>At this point, although nothing is rendered, because of the added log statement the current date is logged to the browser console. </p>\n<h3 id="failing-polymer-import-continued"><a href="#failing-polymer-import-continued" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Failing Polymer import, continued</h3>\n<p>Now the import succeeds and it is clear that the TypeScript compiler correctly processes PolygramApp.ts, it is time to\ntry to fix the import of the <code class="language-text">Polymer</code> module in PolygramApp.ts.</p>\n<p>A possible workaround will be to not try to import HTML imports in the TypeScript file, but instead to supply those dependencies\nthrough the HTML that is importing the TypeScript file. To do this, I change the respective files to:</p>\n<div class="gatsby-highlight">\n      <pre class="language-html"><code class="language-html"><span class="token comment">&lt;!-- polygram-app.html --></span>\n...\n\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dom-module</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>polygram-app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    ...\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">\n        <span class="token comment">// Script</span>\n        <span class="token keyword">import</span> PolygramAppFactory <span class="token keyword">from</span> <span class="token string">\'./PolygramApp\'</span><span class="token punctuation">;</span>\n        <span class="token keyword">const</span> PolygramApp <span class="token operator">=</span> PolygramAppFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>Polymer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        window<span class="token punctuation">.</span>customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span>PolygramApp<span class="token punctuation">.</span>is<span class="token punctuation">,</span> PolygramApp<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dom-module</span><span class="token punctuation">></span></span></code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token comment">// PolygramApp.ts</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> format <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'date-fns\'</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> label<span class="token punctuation">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">\'Current Date: \'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">function</span> <span class="token function">create</span><span class="token punctuation">(</span>Polymer<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">PolygramApp</span> <span class="token keyword">extends</span> <span class="token class-name">Polymer<span class="token punctuation">.</span>Element</span> <span class="token punctuation">{</span>\n        <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">is</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">\'polygram-app\'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword">return</span> <span class="token punctuation">{</span>\n                today<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n                    <span class="token keyword">type</span><span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n                    value<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                        <span class="token keyword">return</span> label <span class="token operator">+</span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">\'YYYY-MM-DD\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    <span class="token punctuation">}</span>\n                <span class="token punctuation">}</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span> create <span class="token punctuation">}</span></code></pre>\n      </div>\n<p>Now everything compiles without errors and the custom elements are rendered again!</p>\n<p>Note here that I also added a <code class="language-text">string</code> type to <code class="language-text">const label</code> to see if typings work.</p>\n<h3 id="re-enabling-redux"><a href="#re-enabling-redux" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Re-enabling Redux</h3>\n<p>Earlier, Redux was disabled to test Webpack. It was failing with the runtime error <code class="language-text">Uncaught ReferenceError: PolymerRedux \nis not defined</code> To re-enable it, I convert the <code class="language-text">polymer-redux/polymer-redux.html</code> from\nbower_components to a local PolymerRedux.js, by just removing the <code class="language-text">script</code> tags.</p>\n<p>Because redux-mixin.html, action.html, and reducer.html actually are already JavaScript wrapped in <code class="language-text">script</code> tags, I just convert\nthem to TypeScript files, for example:</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token comment">// ReduxMixin.ts</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span>combineReducers<span class="token punctuation">,</span> compose<span class="token punctuation">,</span> createStore<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'redux\'</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> PolymerRedux <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">\'exports-loader?PolymerRedux!./PolymerRedux\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token operator">...</span>\n<span class="token keyword">export</span> <span class="token keyword">const</span> ReduxMixin <span class="token operator">=</span> <span class="token function">PolymerRedux</span><span class="token punctuation">(</span>reduxStore<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n      </div>\n<p>To use it in PolygramApp.ts, it can now be imported like a normal ES6 module:</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token comment">// PolygramApp.ts</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> format <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'date-fns\'</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> label<span class="token punctuation">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">\'Current Date: \'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span>ReduxMixin<span class="token punctuation">,</span> reduxStore<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'./ReduxMixin\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">function</span> <span class="token function">create</span><span class="token punctuation">(</span>Polymer<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">PolygramApp</span> <span class="token keyword">extends</span> <span class="token class-name">ReduxMixin</span><span class="token punctuation">(</span>Polymer<span class="token punctuation">.</span>Element<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">is</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">\'polygram-app\'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>\n\n        <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token comment">// Added Redux code here</span>\n            <span class="token operator">...</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token comment">// Added Redux code here</span>\n            <span class="token operator">...</span>\n        <span class="token punctuation">}</span>\n\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span> create <span class="token punctuation">}</span></code></pre>\n      </div>\n<p>After making similar modifications for polygram-searchbox, the Redux events work again as before introducing TypeScript. </p>\n<h2 id="importing-a-global-variable-from-html"><a href="#importing-a-global-variable-from-html" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Importing a global variable from HTML</h2>\n<p>At this point PolymerRedux is loaded from a custom PolymerRedux.js that I made in the previous step by removing the <code class="language-text">&lt;script&gt;</code>\ntags from the file in bower_components. Although this works, it would be better to use the file in bower_components\ndirectly because it will be easier to handle updates to this external package.</p>\n<p>Currently I import the custom PolymerRedux.js in state/ReduxMixin.ts with:</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> PolymerRedux <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">\'exports-loader?PolymerRedux!./PolymerRedux\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n      </div>\n<p>To load the HTML from the bower_components, I expect to have to use the polymer-webpack-loader to extract the JavaScript\nfrom the <code class="language-text">script</code> tags:</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> PolymerRedux <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">\'exports-loader?PolymerRedux!polymer-webpack-loader!../../bower_components/polymer-redux/dist/polymer-redux.html\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n      </div>\n<p>This fails to compile with the message that PolymerRedux is undefined, so I add the <a href="https://github.com/ianwalter/debug-loader">debug-loader</a> to\ninvestigate what the result of each step looks like:</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> PolymerRedux <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">\'exports-loader?PolymerRedux!polymer-webpack-loader!debug-loader?id=raw!../../bower_components/polymer-redux/dist/polymer-redux.html\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n      </div>\n<p>Thanks to debug-loader it is immediately clear that already before going into the polymer-webpack-loader the <code class="language-text">script</code> tags have\nbeen stripped. Just using require without any loaders turns something likes this <code class="language-text">&lt;script&gt;foo()&lt;/script&gt;</code> into <code class="language-text">foo()</code>\nand webpack-polymer-loader is not needed in this case. I do think this only works when the file is completely self\ncontained and does not have dependencies with other Polymer HTML files.</p>\n<p>This is the final working import:</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> PolymerRedux <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">\'exports-loader?PolymerRedux!../../bower_components/polymer-redux/dist/polymer-redux.html\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n      </div>\n<h2 id="linting"><a href="#linting" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Linting</h2>\n<p>Although there is a <a href="https://github.com/Polymer/polymer-linter">polymer-linter</a>, it is <a href="https://github.com/Polymer/polymer-linter#use-with-other-tools">advised</a> to\nuse Polymer Linter combined with other linters, and an obvious choice is TSLint.</p>\n<p>The way that TSLint is configured with Webpack means that it will only lint TypeScript that is not embedded in HTML:</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\n<span class="token keyword">new</span> <span class="token class-name">TSLintPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    files<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'./src/**/*.ts\'</span><span class="token punctuation">]</span> <span class="token comment">// So, this requires none of the TS to be inline in HTML?</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>\n      </div>\n<p>Before I started with this experiment I thought this might be a problem. But now almost all script has been extracted to\nseparate TypeScript files anyway, so this works quite well. </p>\n<p>Of course it is also still possible to run TSLint manually for a file, e.g. <code class="language-text">./node_modules/.bin/tslint --config tslint.json polygram-marvel-details.ts</code></p>\n<p>It is still required to run <code class="language-text">polymer lint</code> manually. As far as I know there is no integration for Webpack yet.</p>\n<h2 id="decorators"><a href="#decorators" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Decorators</h2>\n<p>I want to see if I can use <a href="https://medium.com/google-developers/exploring-es7-decorators-76ecb65fb841">ES decorators</a>,\nbecause decorators conceptually fit with the Mixin pattern used in Polymer\nfor e.g. <code class="language-text">class MyElement extends ReduxMixin(Polymer.Element)</code>. It would be tidy if we could write this as a decorator,\nespecially if more mixins would need to be combined:</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript">@ReduxMixin\n<span class="token keyword">class</span> <span class="token class-name">MyElement</span> <span class="token keyword">extends</span> <span class="token class-name">Polymer<span class="token punctuation">.</span>Element</span>\n<span class="token operator">...</span></code></pre>\n      </div>\n<p>As a test, I just add an <a href="https://medium.com/google-developers/exploring-es7-decorators-76ecb65fb841">example decorator</a>\nto the class in polygram-details.ts:</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript">    @readonly\n    <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token comment">// This works, but prepends a polyfill to the output</span>\n        <span class="token keyword">return</span> <span class="token string">\'just testing a decorator\'</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span></code></pre>\n      </div>\n<p>And in the same file, but outside the class, the definition of the decorator:</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token function">readonly</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> descriptor<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    descriptor<span class="token punctuation">.</span>writable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> descriptor<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p>The compiler fails with: </p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">error TS1219: Experimental support for decorators is a feature that is subject to change in a future release. Set the &#39;experimentalDecorators&#39; option to remove this warning.</code></pre>\n      </div>\n<p>This flag can be added to the compilerOptions section of the tsconfig.json: <code class="language-text">&#39;experimentalDecorators&#39;: true</code>. The\ncompilation now succeeds, but prepends a small polyfill for <code class="language-text">decorator</code> to the output. Take this into account when using\ndecorator in many files, because it will cause an overhead that might be avoided by using a third party library that is\nimported globally.</p>\n<h2 id="app-vs-element"><a href="#app-vs-element" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>App vs Element</h2>\n<p>It is one thing to compile Typescript for a Polymer app, but another thing to use TypeScript for reusable Polymer components.</p>\n<p>The next step will be to compile the Polymer components in this test project separately. As a result, each converted\ncomponent should both be loaded into its own <a href="https://github.com/PolymerElements/iron-component-page">demo page</a> and to be composed into a Polymer app.</p>\n<p>The demo pages should be accessible by running <code class="language-text">polymer serve</code>, conform the normal Polymer workflow.</p>\n<p>When just running a Webpack build for the current project with <code class="language-text">./node_modules/.bin/webpack --config webpack.config.js</code>, it will build a\n<code class="language-text">dist</code> dir containing amongst others an index.html and a bundle.js. This is a standalone app, but this would not be a good workflow to\ndistribute a Polymer component because:</p>\n<ul>\n<li>the index.html is a complete HTML document, not just a <code class="language-text">dom-module</code></li>\n<li>the bundle.js is one huge JavaScript blob that contains not only the compiled JavaScript for the component, but also all templates, TypeScript, Webpack and Polymer polyfills and libraries (like lodash in this case)</li>\n</ul>\n<p>The polyfills and libraries need to be kept separate, so that they can be loaded once per project instead of once for every component.\nThe bundle.js is already 2.8MB in size (unminified) / 347kB (minified).</p>\n<p>Would it be possible to make a Polymer component that uses the <code class="language-text">&lt;script src=&quot;foo.js&quot;&gt;</code> style import and then do a "naive"\ncompilation from foo.ts to foo.js? Let\'s first make a minimal example where the JavaScript is extracted from an Polymer\ncomponent:</p>\n<ul>\n<li>Using <code class="language-text">/polygram-details.html</code> (this is the original, that the TypeScript+Webpack version in /src/ was based on) and <code class="language-text">/demo/polygram-details</code> (already importing /polygram-details)</li>\n<li>Do not run webpack, but just <code class="language-text">polymer serve</code> and test the demo page</li>\n<li>Replace <code class="language-text">&lt;script&gt;... code ...&lt;/script&gt;</code> by <code class="language-text">&lt;script src=&quot;polygram-details.js&quot;&gt;&lt;/script&gt;</code>, extract the JavaScript to\npolygram-details.js and test the demo page again: this works.</li>\n</ul>\n<p>Now to TypeScript:</p>\n<ul>\n<li>Rename <code class="language-text">polygram-detail.js</code> but leave the reference in <code class="language-text">polygram-details.html</code> to point to the JavaScript version: <code class="language-text">&lt;script src=&quot;polygram-details.js&quot;&gt;&lt;/script&gt;</code> </li>\n<li>The package <code class="language-text">typescript</code> was already installed as a dependency, so use <code class="language-text">tsc</code>: <code class="language-text">./node_modules/.bin/tsc polygram-details.ts</code>.\nThis gives errors, but does generate code. The resulting code does not run.</li>\n</ul>\n<p>The first errors are:</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">polygram-details.ts(8,31): error TS2304: Cannot find name &#39;Polymer&#39;.\npolygram-details.ts(33,14): error TS2339: Property &#39;_searchResult&#39; does not exist on type &#39;PolygramDetails&#39;.\npolygram-details.ts(35,18): error TS2339: Property &#39;_searchIAUrl&#39; does not exist on type &#39;PolygramDetails&#39;.\npolygram-details.ts(42,18): error TS2339: Property &#39;_searchResult&#39; does not exist on type &#39;PolygramDetails&#39;.</code></pre>\n      </div>\n<p>Adding <code class="language-text">declare const Polymer: any;</code> fixes these 4 errors. It tells TypeScript a global variable <code class="language-text">Polymer</code> can be expected.  </p>\n<p>This leaves the following errors:</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">polygram-details.ts(9,16): error TS1056: Accessors are only available when targeting ECMAScript 5 and higher.\npolygram-details.ts(13,16): error TS1056: Accessors are only available when targeting ECMAScript 5 and higher.</code></pre>\n      </div>\n<p>The current compilation seems to ignore the tsconfig.json, because a similar error was solved earlier by\nadding <code class="language-text">&quot;target&quot;: &quot;ESNext&quot;</code> in the config. The target can be specified with a flag: <code class="language-text">./node_modules/.bin/tsc --target ES6 polygram-details.ts</code>.\nThis runs without errors and works in the browser!</p>\n<h3 id="simple-compilation-and-webpack"><a href="#simple-compilation-and-webpack" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Simple compilation and Webpack</h3>\n<p>This much simpler approach without Webpack seems to provide a more realistic workflow. Can we afford to leave Webpack\nout entirely? Let\'s reiterate its purpose:</p>\n<h4 id="webpack-transpiles-to-es5-with-babel"><a href="#webpack-transpiles-to-es5-with-babel" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Webpack transpiles to ES5 with Babel</h4>\n<p>As mentioned before we don\'t need Babel for transpilation, the TypeScript compiler can be set to ES6 or ES5. </p>\n<h4 id="webpack-provides-a-development-server-with-hot-module-reloading"><a href="#webpack-provides-a-development-server-with-hot-module-reloading" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Webpack provides a development server with hot module reloading</h4>\n<p>Hot Module Replacement is mainly to ease development, but we can use livereload combined with polyserve instead which would be acceptable for this use case.  </p>\n<h4 id="webpack-handles-module-bundling"><a href="#webpack-handles-module-bundling" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Webpack handles module bundling</h4>\n<p>We can do without ES6 modules or packaging other resources like images as JavaScript modules, because we already have to\ndeal with Polymer Elements as a component platform. We have to distribute the end result as Polymer Elements to be able to add it to the catalog.</p>\n<p>Although Polymer 3 will use ES6 modules, a tool is supposed to become available that can migrate from elements from Polymer 2 to Polymer 3 syntax.</p>\n<p>Without Webpack we lose the module polyfill that is injected per file, which potentially saves a significant size overhead, whilst staying closer to the concept of Polymer Element development.</p>\n<p>Global JavaScript variables from external modules can be made accessible with the <code class="language-text">declare</code> placeholder, and it is still\npossible to use <code class="language-text">import</code> to import from <code class="language-text">node_modules</code>.\nHowever, when module is set to <code class="language-text">none</code> in the tsconfig.json, the variable will just be put onto the "global" scope. This is\nnot the <em>true</em> global scope, because it is still contained within the Polymer element, so the variable will be on the Polymer\nElement scope, and should not leak to the actual global scope. </p>\n<p><code class="language-text">Import</code> should still be used with caution: it will lead to code duplication if 2 Polymer+TypeScript elements import the\nsame dependency. In that case it would be better to import that dependency via HTML import because the Polymer compiler can deduplicate it.</p>\n<p>Webpack can also be used to package CSS as modules, but for encapsulating CSS in Polymer the\n<a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Shadow_DOM">Shadow DOM</a> can be used. This is actually an\naspect of web components that is very well executed.</p>\n<h3 id="automatic-compilation"><a href="#automatic-compilation" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Automatic compilation</h3>\n<p>Without Webpack, it is unpractical that for every change to a TypeScript file a manual transformation is needed. Following\nthe example in the previous section, each time <code class="language-text">polygram-details.ts</code> changes, <code class="language-text">./node_modules/.bin/tsc --target ES6 polygram-details.ts</code>\nmust be run. Let\'s try to automate this without using Webpack.</p>\n<h4 id="with-tsc"><a href="#with-tsc" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>With tsc</h4>\n<p>First I make a new tsconfig named <code class="language-text">tsconfig.inline.json</code> for this use case:</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>\n  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">"sourceMap"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n    <span class="token property">"target"</span><span class="token operator">:</span> <span class="token string">"ES6"</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token property">"include"</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token string">"*.ts"</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p>To compile run <code class="language-text">./node_modules/.bin/tsc -w -p tsconfig.inline.json</code>. The <code class="language-text">-w</code> flag keeps the process running and watches for\nchanges in the included TypeScript files. </p>\n<p>An interesting side-effect occurs. Naturally, each TypeScript file is going to need the <code class="language-text">declare const Polymer: any;</code>\ndeclaration as a workaround for the fact that the Polymer dependency can\'t be imported (see previous sections). But\nbecause we now use <code class="language-text">-p</code>, the project flag, the compiler expects all files share global scope. And the second file\nusing <code class="language-text">declare const Polymer: any;</code> will get an error: <code class="language-text">Cannot redeclare block-scoped variable &#39;Polymer&#39;</code>. How can we use\nthe project flag, without letting the compiler share the global scope between all TypeScript files?</p>\n<p>A workaround would be to create a TypeScript file that just imports/declares all the expected global variables once.\nThis would make the code less transparent at best and it might even create other scoping issues.</p>\n<h3 id="custom-compilation"><a href="#custom-compilation" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Custom compilation</h3>\n<p>As an alternative let\'s try to run compilation with an isolated scope for each TypeScript file. <a href="https://github.com/Microsoft/TypeScript/issues/1516">This issue</a>\nexplains that this would be possible by supplying a tsconfig.json for each scope. That would be doable for a limited set\nof scopes that is static over time (e.g. a back-end codebase and a front-end codebase in the same project).\nHowever, it makes no sense from a maintenance standpoint for the current project as it would need a tsconfig.json\nfor each Polymer element.</p>\n<p>To be complete, I did try this out. First, set up a base tsconfig that can be inherited:</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json">// base.json\n<span class="token punctuation">{</span>\n  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">"sourceMap"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n    <span class="token property">"target"</span><span class="token operator">:</span> <span class="token string">"ESNext"</span><span class="token punctuation">,</span>\n    <span class="token property">"moduleResolution"</span><span class="token operator">:</span> <span class="token string">"node"</span><span class="token punctuation">,</span>\n    <span class="token property">"experimentalDecorators"</span><span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p>Now for each Polymer TypeScript file a tsconfig, e.g.:</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json">// polygram-details.tsconfig.json\n<span class="token punctuation">{</span>\n  <span class="token property">"extends"</span><span class="token operator">:</span> <span class="token string">"./base.json"</span><span class="token punctuation">,</span>\n  <span class="token property">"files"</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token string">"./polygram-details.ts"</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p>It is now possible to compile/watch polygram-details.ts with <code class="language-text">tsc -w -p polygram-details.tsconfig.json</code>, but it is\nstill not possible to compile/watch multiple tsconfigs at <em>the same time</em>.</p>\n<p>In this case it would be better to forget about the watch flag <code class="language-text">-w</code> altogether and just use <code class="language-text">npm watch</code> combined with\n<code class="language-text">tsc [changedfile]</code>. You can\'t use a tsconfig.json combined with an input file path for tsc, so all options must be\nsupplied as flags: <code class="language-text">tsc --target ES6 --sourceMap [changedFile]</code>.</p>\n<p>I tried combining this compilation one-liner with a watch script, but I could not get this to work with <a href="https://www.npmjs.com/package/nodemon">nodemon</a>,\n<a href="https://www.npmjs.com/package/npm-watch">npm-watch</a> or <a href="https://www.npmjs.com/package/watch">watch</a>, so I wrote a small script:</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// ts-poly-watch.js, run with: node ts-poly-watch.js</span>\n<span class="token keyword">const</span> watch <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'watch\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'path\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> chalk <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'chalk\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> tsc <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'node-typescript-compiler\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nwatch<span class="token punctuation">.</span><span class="token function">createMonitor</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token punctuation">{</span> interval<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>monitor<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span>gray<span class="token punctuation">.</span>bgGreen<span class="token punctuation">.</span><span class="token function">bold</span><span class="token punctuation">(</span><span class="token string">\'TS-POLY-WATCH started\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    monitor<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">\'changed\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>f<span class="token punctuation">,</span> curr<span class="token punctuation">,</span> prev<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">const</span> ext <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">extname</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">if</span><span class="token punctuation">(</span>ext <span class="token operator">===</span> <span class="token string">\'.ts\'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f <span class="token operator">+</span> <span class="token string">\' changed\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            tsc<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>\n                <span class="token punctuation">{</span>\n                    <span class="token string">\'target\'</span><span class="token punctuation">:</span> <span class="token string">\'ES6\'</span><span class="token punctuation">,</span>\n                    <span class="token string">\'sourceMap\'</span><span class="token punctuation">:</span> <span class="token boolean">true</span>\n                <span class="token punctuation">}</span><span class="token punctuation">,</span>\n                f\n            <span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n      </div>\n<p>Now it is possible to watch each TypeScript file and compile it with its scope isolated from the other TypeScript files.</p>\n<h2 id="twc"><a href="#twc" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>twc</h2>\n<p>With <code class="language-text">ts-poly-watch.js</code> it looks like we finally have an acceptable working environment. I have extracted the script to\nits own project <a href="https://github.com/mdvanes/typescript-batch-compiler">typescript-batch-compiler</a> and <a href="https://www.npmjs.com/package/typescript-batch-compiler">npm package</a> because\nthere is much room for improvement and it will be easier to use in other projects if it is an npm package.</p>\n<p>So are we now done? In fact there is one more thing I want to explore. During the research I ran into <a href="https://github.com/Draccoz/twc">twc</a>.\nThis is a compiler for <em>TypeScript Web Components</em> and can be used to compile TypeScript classes to Polymer 2 elements.\nAlthough this sounds like it is similar to my <code class="language-text">typescript-batch-compiler</code>, here are some preliminary findings:</p>\n<ol>\n<li>It assumes a TypeScript file as the entrypoint: in my setup I still stay close to the Polymer setup with a\nPolymer element (so HTML) that includes a script file. With <code class="language-text">twc</code> the entrypoint is a TypeScript file that imports an HTML template.\nA great advantage is that this is more like Polymer 3 and also similar to other component driven frameworks\nlike React, Vue and Angular. The disadvantage is of course that the style will be foreign to other Polymer developers.</li>\n<li>It\'s still very experimental. There is no example in the repo or an explanation of how to set up a basic element in the\nREADME, but a general approach is outlined <a href="https://github.com/Draccoz/twc/wiki/Creating-a-simple-component">on the project wiki</a>\nand examples of twc in a project can be found in <a href="https://github.com/mlisook/generator-polymer-init-twc-starter-kit">this generator project</a>.</li>\n</ol>\n<p>With the aforementioned wiki, I take these steps:</p>\n<ul>\n<li>Run <code class="language-text">twc</code> in a new subdir of the project appropriately named "twc"</li>\n<li>Set up a very basic polygram-twc.ts conforming to the style as outlined in the wiki:</li>\n</ul>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token comment">// polygram-twc.ts</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> CustomElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'twc/polymer\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token string">\'bower:polymer/polymer-element.html\'</span><span class="token punctuation">;</span>\n\n<span class="token comment">/**\n * `online-state`\n * Lets you select an online state (online or offline) and reflect the change on a host attribute.\n *\n * @customElement\n * @polymer\n * @demo demo/index.html\n */</span>\n@<span class="token function">CustomElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token keyword">class</span> <span class="token class-name">OnlineState</span> <span class="token keyword">extends</span> <span class="token class-name">Polymer<span class="token punctuation">.</span>Element</span> <span class="token punctuation">{</span>\n    prop1<span class="token punctuation">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">"online-state"</span><span class="token punctuation">;</span>\n\n    <span class="token function">template</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token template-string"><span class="token string">`\n          &lt;style>\n            :host {\n              display: block;\n            }\n          &lt;/style>\n          &lt;h2>Hello [[prop1]]!&lt;/h2>\n        `</span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<ul>\n<li>Run <code class="language-text">tsc --init</code> to create a new tsconfig.json in the twc dir. This turns out to be important. When I re-use my existing\ntsconfig.json the build fails with <code class="language-text">Error: Debug Failure.</code>. This seems to be caused by the line <code class="language-text">&quot;moduleResolution&quot;: &quot;node&quot;</code>,\nwhich is not needed for this compilation.</li>\n<li>Add <code class="language-text">node_modules/twc/types/polymer.decorators.d.ts</code> to the include section of the tsconfig.json, to resolve certain types.</li>\n<li>Build in the twc dir by running <code class="language-text">../node_modules/.bin/twc polygram-twc.ts</code>.</li>\n<li>A polygram-twc.html is created.</li>\n</ul>\n<p>I also converted the original polygram-details.html (the one with embedded JavaScript) to this format. See the result\nin <a href="https://github.com/mdvanes/polygram/tree/TypeScript/twc">the repo for this experiment</a>. When working on this\nconversion, some differences with normal web components become apparent:</p>\n<ul>\n<li>twc auto-injects the registration of the component: <code class="language-text">customElements.define(PolygramDetails.is, PolygramDetails);</code></li>\n<li><code class="language-text">import &#39;./polygram-ui-details&#39;;</code> is converted to <code class="language-text">&lt;link rel=&quot;import&quot; href=&quot;./polygram-ui-details.html&quot;&gt;</code></li>\n<li>the <code class="language-text">is</code> getter, i.e. this: <code class="language-text">static get is() { return &#39;polygram-details&#39;; }</code>\nis auto generated from the class name.</li>\n<li>The JSDoc is converted to an HTML comment.</li>\n</ul>\n<p>This syntax uses plain ES modules and is therefore also closer to Polymer 3. Still there are some differences.\nCompare the code for polygram-twc.ts but in <a href="https://www.polymer-project.org/blog/2017-08-23-hands-on-30-preview">Polymer 3 syntax</a>:</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token comment">// PolymerElement is its own module now, instead of a property of the Polymer namespace. Also, bower is no longer used.</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> Element <span class="token keyword">as</span> PolymerElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'@polymer/polymer/polymer-element\'</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Aside from inline templates, this syntax can be used too:</span>\n<span class="token comment">//import * as view from \'./app.template.html\';</span>\n\n<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">OnlineState</span> <span class="token keyword">extends</span> <span class="token class-name">PolymerElement</span> <span class="token punctuation">{</span>\n    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// Property must be defined in the constructor, but this might be a difference with TypeScript and not Polymer 3.</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>prop1 <span class="token operator">=</span> <span class="token string">\'online-state\'</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">template</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token comment">// I don\'t know where the &lt;style> element should go.</span>\n        <span class="token keyword">return</span> <span class="token template-string"><span class="token string">`&lt;h2>Hello [[prop1]]!&lt;/h2>`</span></span><span class="token punctuation">;</span>\n        <span class="token comment">// Or when using an import:</span>\n        <span class="token comment">//return view;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p>Although I can\'t find any sources, I heard that Polymer 3 would supply an auto converter from (normal) Polymer 2 syntax.\nYou could use that converter on the output of twc, so this should not be a reason to avoid twc.</p>\n<h2 id="final-remarks"><a href="#final-remarks" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Final remarks</h2>\n<p>Unit testing and coverage support when using TypeScript has not been mentioned, but I hope it is clear that it is\nunchanged from a normal Polymer 2 application when using typescript-batch-compiler. You can just use\n<a href="https://github.com/Polymer/web-component-tester">WCT</a>), because all components\nare compiled to a state that conforms to a non-TypeScript Polymer 2 situation.</p>\n<p>For the Webpack approach it would be an improvement to see why <code class="language-text">polymer-webpack-loader</code> is not importing Polymer when\nusing <code class="language-text">import Polymer from &#39;../bower_components/polymer/polymer-element.html&#39;</code>\nor <code class="language-text">import &#39;../bower_components/polymer/polymer-element.html&#39;</code>.</p>\n<p>It could also be an improvement to add the <a href="https://www.npmjs.com/package/tslint-plugin-prettier">prettier</a> plugin to promote a\nconsistent coding style. This could be added to TSLint via Webpack, but could also be integrated in the\ntypescript-batch-compiler package.</p>',
htmlAst:{type:"root",children:[{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"For "},{type:"element",tagName:"a",properties:{href:"../polymer-2-and-redux/"},children:[{type:"text",value:"reasons beyond my control"}]},{type:"text",value:" I'm working with\nPolymer 2 at the moment. Although the idea of web components is great, the choice for HTML imports that comes with\nPolymer 2 makes integration into a modern development stack cumbersome, as will become clear soon. Also, HTML\nimports are not widely supported by browsers and although polyfills exist, only "},{type:"element",tagName:"a",properties:{href:"https://caniuse.com/#search=html%20imports"},children:[{type:"text",value:"Chrome (surprise!)"}]},{type:"text",value:"\nwill have native support for the foreseeable future."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Using TypeScript seems like a good choice, because static typing helps prevent runtime errors. Additionally it would be a\ngood opportunity to try out the "},{type:"element",tagName:"a",properties:{href:"https://github.com/code-star/scala-ts-interfaces"},children:[{type:"text",value:"Scala-TS-interfaces project"}]},{type:"text",value:" by my\ncolleagues, that can generate TypeScript from a Scala domain model. Unfortunately, adding TypeScript to a Polymer 2\ndevelopment stack proves to be difficult, whereas using it with Polymer 3 seems trivial. Polymer 3 is currently in\npreview so it is not a viable option for me for the moment, but it will exchange HTML imports for ES6 Modules. This will\nmake integrating it into a modern development stack much easier. An "},{type:"element",tagName:"a",properties:{href:"https://github.com/mdvanes/polymer3-typescript"},children:[{type:"text",value:"example"}]},{type:"text",value:"\nalready exists, by "},{type:"element",tagName:"a",properties:{href:"https://github.com/pferretti"},children:[{type:"text",value:"Paolo Ferretti"}]},{type:"text",value:" and follows normal conventions for a TypeScript project."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"If you're adventurous, don't need any "},{type:"element",tagName:"a",properties:{href:"https://www.webcomponents.org/"},children:[{type:"text",value:"existing Polymer 2 elements"}]},{type:"text",value:" and don't need to\nrun production; stop reading here and use Polymer 3.\nIf you need Polymer 2 read on, but be warned that it won't be pretty."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"strong",properties:{},children:[{type:"text",value:"TL;DR to use TypeScript with Polymer 2 use "},{type:"element",tagName:"a",properties:{href:"https://github.com/mdvanes/typescript-batch-compiler"},children:[{type:"text",value:"typescript-batch-compiler"}]},{type:"text",value:" or even better "},{type:"element",tagName:"a",properties:{href:"https://github.com/Draccoz/twc"},children:[{type:"text",value:"twc"}]},{type:"text",value:"."}]}]},{type:"text",value:"\n"},{type:"element",tagName:"h2",properties:{id:"webpack"},children:[{type:"element",tagName:"a",properties:{href:"#webpack",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Webpack"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"For this experiment I will use my existing Polygram project and the result will be available in the "},{type:"element",tagName:"a",properties:{href:"https://github.com/mdvanes/polygram/tree/TypeScript"},children:[{type:"text",value:"TypeScript branch"}]},{type:"text",value:". "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The first challenge is to use Webpack with Polymer 2. Although not strictly necessary for TypeScript compilation, it would\nmake sense for importing HTML as modules. Fortunately, "},{type:"element",tagName:"a",properties:{href:"https://www.youtube.com/playlist?list=PLOU2XLYxmsII5c3Mgw6fNYCzaWrsM3sMN"},children:[{type:"text",value:"Rob Dodson himself"}]},{type:"text",value:" wrote an\narticle "},{type:"element",tagName:"a",properties:{href:"http://robdodson.me/how-to-use-polymer-with-webpack/"},children:[{type:"text",value:"How to use Polymer with Webpack"}]},{type:"text",value:". It even mentions TypeScript!\nThe article introduces the Webpack loader "},{type:"element",tagName:"a",properties:{href:"https://github.com/webpack-contrib/polymer-webpack-loader"},children:[{type:"text",value:"https://github.com/webpack-contrib/polymer-webpack-loader"}]},{type:"text",value:" and\nexplains how it extracts the JavaScript from the HTML of Polymer elements and eventually packages everything into one\nJavaScript file. I was basically able to copy the webpack.config.js and index.ejs from his demo project, place it into Polygram and that would compile. I moved my\n"},{type:"element",tagName:"a",properties:{href:"https://github.com/mdvanes/polygram/tree/TypeScript"},children:[{type:"text",value:"custom elements"}]},{type:"text",value:" from the root of the project to the src dir and I had\nto modify the paths to the bower_components and it would basically work. "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The most important exception is Redux, the redux-mixin.html can't resolve the PolymerRedux.html dependency (in bower_components/polymer-redux/polymer-redux.html).\nThe polymer-webpack-loader should resolve this, but runtime it logs "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Uncaught ReferenceError: PolymerRedux is not defined"}]},{type:"text",value:".\nE.g. for src/polygram-app.html, the loader seems to import the HTML elements that are used in the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"template"}]},{type:"text",value:" element,\nbut not the JavaScript variables that are used in the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"script"}]},{type:"text",value:" element."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The PolymerRedux code is distributed as JavaScript wrapped in a "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"script"}]},{type:"text",value:" tag in mainly one file, so it would be easy to\nextract it to a JavaScript file. Or even to import "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"polymer-redux/src/index.js"}]},{type:"text",value:" instead of "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"polymer-redux/polymer-redux.html"}]},{type:"text",value:"\n(although index.js is uncompiled and misses external dependencies that are not installed in bower_components because they are development dependencies of polymer-redux).\nFor now, I just comment out the Redux dependencies."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"It is already clear now that the result from Webpack will be one huge bundle.js that inlines all JavaScript and HTML\ndependencies. This means using the "},{type:"element",tagName:"a",properties:{href:"https://www.polymer-project.org/2.0/toolbox/prpl"},children:[{type:"text",value:"PRPL pattern"}]},{type:"text",value:" will not be possible\nin this workflow, nor will it be possible to have standalone Polymer components and the accompanying Polymer demo pages."}]},{type:"text",value:"\n"},{type:"element",tagName:"h2",properties:{id:"adding-ts-loader"},children:[{type:"element",tagName:"a",properties:{href:"#adding-ts-loader",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Adding ts-loader"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Normally, to migrate a Webpack project from JavaScript to TypeScript, it would be enough to add the "},{type:"element",tagName:"a",properties:{href:"https://github.com/TypeStrong/ts-loader"},children:[{type:"text",value:"ts-loader"}]},{type:"text",value:"\nto the Webpack config and to rename the JavaScript files to TypeScript files. "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"So I started with changing the extension for the bootstrapping index.js and adding .ts as a resolved extension:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"code",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// webpack.config.js"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"..."}]},{type:"text",value:"\nentry"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" path"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"resolve"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"__dirname"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'src/index.ts'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"..."}]},{type:"text",value:"\nresolve"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n        extensions"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'.ts'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'.js'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"..."}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"And adding this rule:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"code",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// webpack.config.js"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n    test"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","regex"]},children:[{type:"text",value:"/\\.ts?$/"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"\n    use"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" loader"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'ts-loader'"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"And creating a tsconfig.json:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"code",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n  "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"compilerOptions"'}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"sourceMap"'}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","boolean"]},children:[{type:"text",value:"true"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"\n  "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Everything still compiles, but the JavaScript for the Polymer components is embedded in the HTML and therefore ignored\nby the new rule with the ts-loader."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Adding the ts-loader to the rule for the HTML files breaks compilation:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"code",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// webpack.config.js"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n    test"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","regex"]},children:[{type:"text",value:"/\\.html$/"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"\n    use"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" loader"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'babel-loader'"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" loader"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'ts-loader'"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// <--"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" loader"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'polymer-webpack-loader'"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Even without changing any of the code itself, compilation fails with:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-text"]},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"ERROR in ./src/polygram-app.html\nModule build failed: Error: Could not find file: '/home/me/polygram/src/polygram-app.html'."}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Well, that just doesn't look healthy. I filed "},{type:"element",tagName:"a",properties:{href:"https://github.com/webpack-contrib/polymer-webpack-loader/issues/64"},children:[{type:"text",value:"a bug"}]},{type:"text",value:"\nand almost 2 months after my report the maintainers closed the issue commenting that the root cause is with Webpack, so I\ndon't see this will be resolved any time soon."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"For now, I will try to work around it by extracting the TypeScript code to a separate file. "}]},{type:"text",value:"\n"},{type:"element",tagName:"h3",properties:{id:"workaround-for-typescript-compilation-in-a-polymer-element"},children:[{type:"element",tagName:"a",properties:{href:"#workaround-for-typescript-compilation-in-a-polymer-element",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Workaround for TypeScript compilation in a Polymer element"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"After removing the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"ts-loader"}]},{type:"text",value:" line from the HTML rule in the webpack.config.js I set out to extract the TypeScript to a\nseparate file so it can be compiled with the rule that matches ts files. "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Roughly, the main entry point for the Polymer elements "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"polygram-app.html"}]},{type:"text",value:" contains:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-html"]},children:[{type:"element",tagName:"code",properties:{className:["language-html"]},children:[{type:"text",value:"// imports\n"},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"<"}]},{type:"text",value:"link"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","attr-name"]},children:[{type:"text",value:"rel"}]},{type:"element",tagName:"span",properties:{className:["token","attr-value"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]},{type:"text",value:"import"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","attr-name"]},children:[{type:"text",value:"href"}]},{type:"element",tagName:"span",properties:{className:["token","attr-value"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]},{type:"text",value:"../bower_components/polymer/polymer-element.html"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"text",value:"\n...\n"},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"<"}]},{type:"text",value:"link"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","attr-name"]},children:[{type:"text",value:"rel"}]},{type:"element",tagName:"span",properties:{className:["token","attr-value"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]},{type:"text",value:"import"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","attr-name"]},children:[{type:"text",value:"href"}]},{type:"element",tagName:"span",properties:{className:["token","attr-value"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]},{type:"text",value:"polygram-details.html"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"<"}]},{type:"text",value:"link"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","attr-name"]},children:[{type:"text",value:"rel"}]},{type:"element",tagName:"span",properties:{className:["token","attr-value"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]},{type:"text",value:"import"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","attr-name"]},children:[{type:"text",value:"href"}]},{type:"element",tagName:"span",properties:{className:["token","attr-value"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]},{type:"text",value:"polygram-searchbox.html"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"text",value:"\n\n"},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"<"}]},{type:"text",value:"dom-module"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","attr-name"]},children:[{type:"text",value:"id"}]},{type:"element",tagName:"span",properties:{className:["token","attr-value"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]},{type:"text",value:"polygram-app"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"<"}]},{type:"text",value:"template"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"<!-- Style -->"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"<"}]},{type:"text",value:"style"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","attr-name"]},children:[{type:"text",value:"include"}]},{type:"element",tagName:"span",properties:{className:["token","attr-value"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]},{type:"text",value:"iron-flex iron-flex-alignment"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]
},children:[{type:"text",value:'"'}]}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"element",tagName:"span",properties:{className:["token","style","language-css"]},children:[]},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"</"}]},{type:"text",value:"style"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"text",value:"\n\n        "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"<!-- Markup -->"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"<"}]},{type:"text",value:"div"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","attr-name"]},children:[{type:"text",value:"class"}]},{type:"element",tagName:"span",properties:{className:["token","attr-value"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]},{type:"text",value:"layout vertical"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"text",value:"\n            ...\n        "},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"</"}]},{type:"text",value:"div"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"text",value:"\n        ...\n    "},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"</"}]},{type:"text",value:"template"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"<"}]},{type:"text",value:"script"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"element",tagName:"span",properties:{className:["token","script","language-javascript"]},children:[{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// Script"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"import"}]},{type:"text",value:" format "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"from"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'date-fns/format'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"class"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"PolygramApp"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"extends"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"Polymer"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"Element"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n            "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"static"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"get"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"is"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'polygram-app'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n            "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"static"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"get"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"properties"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n                "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n                    today"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n                        type"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" String"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"\n                        value"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"function"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n                            "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"format"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"new"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"Date"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'MM/DD/YYYY'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n                        "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n                    "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n                "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n            "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n        window"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"customElements"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"define"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"PolygramApp"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"is"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" PolygramApp"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n    "}]},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"</"}]},{type:"text",value:"script"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"</"}]},{type:"text",value:"dom-module"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Since I know the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"import"}]},{type:"text",value:" statement in the script tag works, I can use this to my advantage. Lets create a companion\nTypeScript file for polygram-app.html named PolygramApp.ts."}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"code",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// PolygramApp.ts"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"import"}]},{type:"text",value:" format "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"from"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'date-fns/format'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"export"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"default"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"class"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"PolygramApp"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"extends"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"Polymer"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"Element"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"static"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"get"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"is"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'polygram-app'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"static"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"get"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"properties"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n            today"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n                "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"type"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" String"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"\n                value"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"function"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n                    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"format"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"new"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"Date"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'MM/DD/YYYY'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n                "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n            "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"It would be possible to import PolygramApp.ts with "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:'<script src="PolygramApp.ts"></script'}]},{type:"text",value:", but I like the standard ES6 module structure\nof PolygramApp.ts without the added responsibility of registering itself to customElements, so I import it like this:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-html"]},children:[{type:"element",tagName:"code",properties:{className:["language-html"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"<!-- polygram-app.html -->"}]},{type:"text",value:"\n...\n\n"},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"<"}]},{type:"text",value:"dom-module"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","attr-name"]},children:[{type:"text",value:"id"}]},{type:"element",tagName:"span",properties:{className:["token","attr-value"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]},{type:"text",value:"polygram-app"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"text",value:"\n    ...\n    "},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"<"}]},{type:"text",value:"script"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"element",tagName:"span",properties:{className:["token","script","language-javascript"]},children:[{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// Script"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"import"}]},{type:"text",value:" PolygramApp "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"from"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'./polygramApp'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n        window"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"customElements"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"define"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"PolygramApp"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"is"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" PolygramApp"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n    "}]},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"</"}]},{type:"text",value:"script"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"</"}]},{type:"text",value:"dom-module"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The result is a failed compilation with 3 types of errors. Let's deal with them one by one."}]},{type:"text",value:"\n"},{type:"element",tagName:"h3",properties:{id:"1-failing-accessors"},children:[{type:"element",tagName:"a",properties:{href:"#1-failing-accessors",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"1. Failing accessors"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"is"}]},{type:"text",value:" and "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"properties"}]},{type:"text",value:" getters require a specifically set target ECMAScript version, the compilation error is:\n"},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"error TS1056: Accessors are only available when targeting ECMAScript 5 and higher"}]},{type:"text",value:". It surprises me that the default\nES target is ES3, but it's not a problem to use ES5 or even ESNext here, because the babel-loader will transpile it back to ES5."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Adding "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:'"target": "ESNext"'}]},{type:"text",value:" to compilerOptions in the tsconfig.json fixes this error."}]},{type:"text",value:"\n"},{type:"element",tagName:"h3",properties:{id:"2-failing-polymer-import"},children:[{type:"element",tagName:"a",properties:{href:"#2-failing-polymer-import",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"2. Failing Polymer import"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Polymer"}]},{type:"text",value:" can't be found for the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"extends"}]},{type:"text",value:". This is the most difficult of these errors to solve, because it is caused by the preferred module\narchitecture of Polymer 2: because HTML imports are used, it is not possible to use "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"import Polymer from '../bower_components/polymer/polymer-element.html'"}]},{type:"text",value:"\nbecause this polymer-element does not export "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Polymer"}]},{type:"text",value:" as an ES6 module. The webpack-polymer-loader can resolve HTML\nimports, but using "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"import '../bower_components/polymer/polymer-element.html'"}]},{type:"text",value:" results in an "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"error TS2304: Cannot find name 'Polymer'"}]},{type:"text",value:"."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"For the moment, I'm just removing the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"extends Polymer.Element"}]},{type:"text",value:" from PolygramApps.ts and "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"window.customElements.define(PolygramApp.is, PolygramApp);"}]},{type:"text",value:" from polygram-app.html."}]},{type:"text",value:"\n"},{type:"element",tagName:"h3",properties:{id:"3-failing-date-fns-import"},children:[{type:"element",tagName:"a",properties:{href:"#3-failing-date-fns-import",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
},children:[]}]}]},{type:"text",value:"3. Failing date-fns import"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"To be able to continue resolving the compilation errors, I add a log statement to polygram-app.html:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-html"]},children:[{type:"element",tagName:"code",properties:{className:["language-html"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"<!-- polygram-app.html -->"}]},{type:"text",value:"\n...\n\n"},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"<"}]},{type:"text",value:"dom-module"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","attr-name"]},children:[{type:"text",value:"id"}]},{type:"element",tagName:"span",properties:{className:["token","attr-value"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]},{type:"text",value:"polygram-app"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"text",value:"\n    ...\n    "},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"<"}]},{type:"text",value:"script"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"element",tagName:"span",properties:{className:["token","script","language-javascript"]},children:[{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// Script"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"import"}]},{type:"text",value:" PolygramApp "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"from"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'./polygramApp'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n        console"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"log"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"PolygramApp"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"properties"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"today"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"value"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n    "}]},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"</"}]},{type:"text",value:"script"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"</"}]},{type:"text",value:"dom-module"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The import of date-fns originally failed in the TypeScript compilation with\n"},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"error TS1192: Module ''date-fns/format'' has no default export."}]},{type:"text",value:" but at this point that has two different behaviors:"}]},{type:"text",value:"\n"},{type:"element",tagName:"ul",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"The IDE warns "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"TS2307 Cannot find module date-fns"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Compilation succeeds, but this error is logged in the browser: "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Uncaught TypeError: format_1.default is not a function(…)"}]}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"I first thought that this was caused by missing typings for the date-fns library, so I tried\n"},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"npm install @types/date-fns"}]},{type:"text",value:" but this logs that date-fns actually provides typings."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Eventually I was able to fix the Uncaught TypeError by changing the import in PolygramApp.ts from"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"code",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"import"}]},{type:"text",value:" format "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"from"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'date-fns/format'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"to"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"code",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"import"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" format "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"from"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'date-fns'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"And the IDE warning by adding "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:'"moduleResolution": "node"'}]},{type:"text",value:" to the compilerOptions in tsconfig.json."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"At this point, although nothing is rendered, because of the added log statement the current date is logged to the browser console. "}]},{type:"text",value:"\n"},{type:"element",tagName:"h3",properties:{id:"failing-polymer-import-continued"},children:[{type:"element",tagName:"a",properties:{href:"#failing-polymer-import-continued",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Failing Polymer import, continued"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Now the import succeeds and it is clear that the TypeScript compiler correctly processes PolygramApp.ts, it is time to\ntry to fix the import of the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Polymer"}]},{type:"text",value:" module in PolygramApp.ts."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"A possible workaround will be to not try to import HTML imports in the TypeScript file, but instead to supply those dependencies\nthrough the HTML that is importing the TypeScript file. To do this, I change the respective files to:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-html"]},children:[{type:"element",tagName:"code",properties:{className:["language-html"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"<!-- polygram-app.html -->"}]},{type:"text",value:"\n...\n\n"},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"<"}]},{type:"text",value:"dom-module"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","attr-name"]},children:[{type:"text",value:"id"}]},{type:"element",tagName:"span",properties:{className:["token","attr-value"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]},{type:"text",value:"polygram-app"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"text",value:"\n    ...\n    "},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"<"}]},{type:"text",value:"script"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"element",tagName:"span",properties:{className:["token","script","language-javascript"]},children:[{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// Script"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"import"}]},{type:"text",value:" PolygramAppFactory "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"from"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'./PolygramApp'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" PolygramApp "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" PolygramAppFactory"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"create"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"Polymer"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n        window"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"customElements"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"define"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"PolygramApp"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"is"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" PolygramApp"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n    "}]},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"</"}]},{type:"text",value:"script"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"</"}]},{type:"text",value:"dom-module"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"code",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// PolygramApp.ts"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"import"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" format "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"from"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'date-fns'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" label"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"string"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'Current Date: '"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"function"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"create"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"Polymer"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"class"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"PolygramApp"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"extends"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"Polymer"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"Element"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"static"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"get"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"is"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'polygram-app'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"static"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"get"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"properties"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n            "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n                today"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n                    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"type"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" String"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"\n                    value"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"function"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n                        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" label "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"format"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"new"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"Date"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'YYYY-MM-DD'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n                    "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n                "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n            "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"export"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"default"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" create "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Now everything compiles without errors and the custom elements are rendered again!"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Note here that I also added a "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"string"}]},{type:"text",value:" type to "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"const label"}]},{type:"text",value:" to see if typings work."}]},{type:"text",value:"\n"},{type:"element",tagName:"h3",properties:{id:"re-enabling-redux"},children:[{type:"element",tagName:"a",properties:{href:"#re-enabling-redux",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Re-enabling Redux"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Earlier, Redux was disabled to test Webpack. It was failing with the runtime error "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Uncaught ReferenceError: PolymerRedux \nis not defined"}]},{type:"text",value:" To re-enable it, I convert the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"polymer-redux/polymer-redux.html"}]},{type:"text",value:" from\nbower_components to a local PolymerRedux.js, by just removing the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"script"}]},{type:"text",value:" tags."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Because redux-mixin.html, action.html, and reducer.html actually are already JavaScript wrapped in "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"script"}]},{type:"text",value:" tags, I just convert\nthem to TypeScript files, for example:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"code",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// ReduxMixin.ts"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"import"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"combineReducers"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" compose"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" createStore"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"from"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'redux'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" PolymerRedux "},{
type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"require"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'exports-loader?PolymerRedux!./PolymerRedux'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"..."}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"export"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" ReduxMixin "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"PolymerRedux"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"reduxStore"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"To use it in PolygramApp.ts, it can now be imported like a normal ES6 module:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"code",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// PolygramApp.ts"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"import"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" format "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"from"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'date-fns'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" label"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"string"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'Current Date: '"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"import"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"ReduxMixin"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" reduxStore"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"from"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'./ReduxMixin'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"function"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"create"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"Polymer"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"class"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"PolygramApp"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"extends"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"ReduxMixin"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"Polymer"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"Element"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"static"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"get"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"is"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'polygram-app'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"static"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"get"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"properties"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n            "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// Added Redux code here"}]},{type:"text",value:"\n            "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"..."}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n\n        "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"ready"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n            "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// Added Redux code here"}]},{type:"text",value:"\n            "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"..."}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n\n    "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"export"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"default"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" create "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"After making similar modifications for polygram-searchbox, the Redux events work again as before introducing TypeScript. "}]},{type:"text",value:"\n"},{type:"element",tagName:"h2",properties:{id:"importing-a-global-variable-from-html"},children:[{type:"element",tagName:"a",properties:{href:"#importing-a-global-variable-from-html",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Importing a global variable from HTML"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"At this point PolymerRedux is loaded from a custom PolymerRedux.js that I made in the previous step by removing the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"<script>"}]},{type:"text",value:"\ntags from the file in bower_components. Although this works, it would be better to use the file in bower_components\ndirectly because it will be easier to handle updates to this external package."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Currently I import the custom PolymerRedux.js in state/ReduxMixin.ts with:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"code",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" PolymerRedux "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"require"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'exports-loader?PolymerRedux!./PolymerRedux'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"To load the HTML from the bower_components, I expect to have to use the polymer-webpack-loader to extract the JavaScript\nfrom the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"script"}]},{type:"text",value:" tags:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"code",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" PolymerRedux "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"require"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'exports-loader?PolymerRedux!polymer-webpack-loader!../../bower_components/polymer-redux/dist/polymer-redux.html'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"This fails to compile with the message that PolymerRedux is undefined, so I add the "},{type:"element",tagName:"a",properties:{href:"https://github.com/ianwalter/debug-loader"},children:[{type:"text",value:"debug-loader"}]},{type:"text",value:" to\ninvestigate what the result of each step looks like:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"code",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" PolymerRedux "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"require"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'exports-loader?PolymerRedux!polymer-webpack-loader!debug-loader?id=raw!../../bower_components/polymer-redux/dist/polymer-redux.html'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Thanks to debug-loader it is immediately clear that already before going into the polymer-webpack-loader the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"script"}]},{type:"text",value:" tags have\nbeen stripped. Just using require without any loaders turns something likes this "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"<script>foo()</script>"}]},{type:"text",value:" into "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"foo()"}]},{type:"text",value:"\nand webpack-polymer-loader is not needed in this case. I do think this only works when the file is completely self\ncontained and does not have dependencies with other Polymer HTML files."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"This is the final working import:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"code",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" PolymerRedux "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"require"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'exports-loader?PolymerRedux!../../bower_components/polymer-redux/dist/polymer-redux.html'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"h2",properties:{id:"linting"},children:[{type:"element",tagName:"a",properties:{href:"#linting",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Linting"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Although there is a "},{type:"element",tagName:"a",properties:{href:"https://github.com/Polymer/polymer-linter"},children:[{type:"text",value:"polymer-linter"}]},{type:"text",value:", it is "},{type:"element",tagName:"a",properties:{href:"https://github.com/Polymer/polymer-linter#use-with-other-tools"},children:[{type:"text",value:"advised"}]},{type:"text",value:" to\nuse Polymer Linter combined with other linters, and an obvious choice is TSLint."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The way that TSLint is configured with Webpack means that it will only lint TypeScript that is not embedded in HTML:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"code",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// webpack.config.js"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"new"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"TSLintPlugin"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n    files"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'./src/**/*.ts'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// So, this requires none of the TS to be inline in HTML?"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Before I started with this experiment I thought this might be a problem. But now almost all script has been extracted to\nseparate TypeScript files anyway, so this works quite well. "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Of course it is also still possible to run TSLint manually for a file, e.g. "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"./node_modules/.bin/tslint --config tslint.json polygram-marvel-details.ts"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"It is still required to run "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"polymer lint"}]},{type:"text",value:" manually. As far as I know there is no integration for Webpack yet."}]},{type:"text",value:"\n"},{type:"element",tagName:"h2",properties:{id:"decorators"},children:[{type:"element",tagName:"a",properties:{href:"#decorators",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Decorators"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"I want to see if I can use "},{type:"element",tagName:"a",properties:{href:"https://medium.com/google-developers/exploring-es7-decorators-76ecb65fb841"},children:[{type:"text",value:"ES decorators"}]},{type:"text",value:",\nbecause decorators conceptually fit with the Mixin pattern used in Polymer\nfor e.g. "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"class MyElement extends ReduxMixin(Polymer.Element)"}]},{type:"text",value:". It would be tidy if we could write this as a decorator,\nespecially if more mixins would need to be combined:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"code",properties:{className:["language-typescript"]},children:[{type:"text",value:"@ReduxMixin\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"class"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"MyElement"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"extends"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"Polymer"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"Element"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"..."}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"As a test, I just add an "},{type:"element",tagName:"a",properties:{href:"https://medium.com/google-developers/exploring-es7-decorators-76ecb65fb841"},children:[{type:"text",value:"example decorator"}]},{type:"text",value:"\nto the class in polygram-details.ts:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"code",properties:{className:["language-typescript"]},children:[{type:"text",value:"    @readonly\n    "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"foo"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// This works, but prepends a polyfill to the output"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'just testing a decorator'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"And in the same file, but outside the class, the definition of the decorator:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"code",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"function"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"readonly"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"target"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" key"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" descriptor"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n    descriptor"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"writable "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","boolean"]},children:[{type:"text",value:"false"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" descriptor"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{
type:"text",value:"The compiler fails with: "}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-text"]},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"error TS1219: Experimental support for decorators is a feature that is subject to change in a future release. Set the 'experimentalDecorators' option to remove this warning."}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"This flag can be added to the compilerOptions section of the tsconfig.json: "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"'experimentalDecorators': true"}]},{type:"text",value:". The\ncompilation now succeeds, but prepends a small polyfill for "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"decorator"}]},{type:"text",value:" to the output. Take this into account when using\ndecorator in many files, because it will cause an overhead that might be avoided by using a third party library that is\nimported globally."}]},{type:"text",value:"\n"},{type:"element",tagName:"h2",properties:{id:"app-vs-element"},children:[{type:"element",tagName:"a",properties:{href:"#app-vs-element",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"App vs Element"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"It is one thing to compile Typescript for a Polymer app, but another thing to use TypeScript for reusable Polymer components."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The next step will be to compile the Polymer components in this test project separately. As a result, each converted\ncomponent should both be loaded into its own "},{type:"element",tagName:"a",properties:{href:"https://github.com/PolymerElements/iron-component-page"},children:[{type:"text",value:"demo page"}]},{type:"text",value:" and to be composed into a Polymer app."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The demo pages should be accessible by running "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"polymer serve"}]},{type:"text",value:", conform the normal Polymer workflow."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"When just running a Webpack build for the current project with "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"./node_modules/.bin/webpack --config webpack.config.js"}]},{type:"text",value:", it will build a\n"},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"dist"}]},{type:"text",value:" dir containing amongst others an index.html and a bundle.js. This is a standalone app, but this would not be a good workflow to\ndistribute a Polymer component because:"}]},{type:"text",value:"\n"},{type:"element",tagName:"ul",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"the index.html is a complete HTML document, not just a "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"dom-module"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"the bundle.js is one huge JavaScript blob that contains not only the compiled JavaScript for the component, but also all templates, TypeScript, Webpack and Polymer polyfills and libraries (like lodash in this case)"}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The polyfills and libraries need to be kept separate, so that they can be loaded once per project instead of once for every component.\nThe bundle.js is already 2.8MB in size (unminified) / 347kB (minified)."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Would it be possible to make a Polymer component that uses the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:'<script src="foo.js">'}]},{type:"text",value:' style import and then do a "naive"\ncompilation from foo.ts to foo.js? Let\'s first make a minimal example where the JavaScript is extracted from an Polymer\ncomponent:'}]},{type:"text",value:"\n"},{type:"element",tagName:"ul",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Using "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"/polygram-details.html"}]},{type:"text",value:" (this is the original, that the TypeScript+Webpack version in /src/ was based on) and "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"/demo/polygram-details"}]},{type:"text",value:" (already importing /polygram-details)"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Do not run webpack, but just "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"polymer serve"}]},{type:"text",value:" and test the demo page"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Replace "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"<script>... code ...</script>"}]},{type:"text",value:" by "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:'<script src="polygram-details.js"></script>'}]},{type:"text",value:", extract the JavaScript to\npolygram-details.js and test the demo page again: this works."}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Now to TypeScript:"}]},{type:"text",value:"\n"},{type:"element",tagName:"ul",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Rename "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"polygram-detail.js"}]},{type:"text",value:" but leave the reference in "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"polygram-details.html"}]},{type:"text",value:" to point to the JavaScript version: "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:'<script src="polygram-details.js"></script>'}]},{type:"text",value:" "}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"The package "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"typescript"}]},{type:"text",value:" was already installed as a dependency, so use "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"tsc"}]},{type:"text",value:": "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"./node_modules/.bin/tsc polygram-details.ts"}]},{type:"text",value:".\nThis gives errors, but does generate code. The resulting code does not run."}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The first errors are:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-text"]},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"polygram-details.ts(8,31): error TS2304: Cannot find name 'Polymer'.\npolygram-details.ts(33,14): error TS2339: Property '_searchResult' does not exist on type 'PolygramDetails'.\npolygram-details.ts(35,18): error TS2339: Property '_searchIAUrl' does not exist on type 'PolygramDetails'.\npolygram-details.ts(42,18): error TS2339: Property '_searchResult' does not exist on type 'PolygramDetails'."}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Adding "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"declare const Polymer: any;"}]},{type:"text",value:" fixes these 4 errors. It tells TypeScript a global variable "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Polymer"}]},{type:"text",value:" can be expected.  "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"This leaves the following errors:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-text"]},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"polygram-details.ts(9,16): error TS1056: Accessors are only available when targeting ECMAScript 5 and higher.\npolygram-details.ts(13,16): error TS1056: Accessors are only available when targeting ECMAScript 5 and higher."}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The current compilation seems to ignore the tsconfig.json, because a similar error was solved earlier by\nadding "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:'"target": "ESNext"'}]},{type:"text",value:" in the config. The target can be specified with a flag: "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"./node_modules/.bin/tsc --target ES6 polygram-details.ts"}]},{type:"text",value:".\nThis runs without errors and works in the browser!"}]},{type:"text",value:"\n"},{type:"element",tagName:"h3",properties:{id:"simple-compilation-and-webpack"},children:[{type:"element",tagName:"a",properties:{href:"#simple-compilation-and-webpack",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Simple compilation and Webpack"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"This much simpler approach without Webpack seems to provide a more realistic workflow. Can we afford to leave Webpack\nout entirely? Let's reiterate its purpose:"}]},{type:"text",value:"\n"},{type:"element",tagName:"h4",properties:{id:"webpack-transpiles-to-es5-with-babel"},children:[{type:"element",tagName:"a",properties:{href:"#webpack-transpiles-to-es5-with-babel",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Webpack transpiles to ES5 with Babel"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"As mentioned before we don't need Babel for transpilation, the TypeScript compiler can be set to ES6 or ES5. "}]},{type:"text",value:"\n"},{type:"element",tagName:"h4",properties:{id:"webpack-provides-a-development-server-with-hot-module-reloading"},children:[{type:"element",tagName:"a",properties:{href:"#webpack-provides-a-development-server-with-hot-module-reloading",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Webpack provides a development server with hot module reloading"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Hot Module Replacement is mainly to ease development, but we can use livereload combined with polyserve instead which would be acceptable for this use case.  "}]},{type:"text",value:"\n"},{type:"element",tagName:"h4",properties:{id:"webpack-handles-module-bundling"},children:[{type:"element",tagName:"a",properties:{href:"#webpack-handles-module-bundling",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Webpack handles module bundling"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"We can do without ES6 modules or packaging other resources like images as JavaScript modules, because we already have to\ndeal with Polymer Elements as a component platform. We have to distribute the end result as Polymer Elements to be able to add it to the catalog."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Although Polymer 3 will use ES6 modules, a tool is supposed to become available that can migrate from elements from Polymer 2 to Polymer 3 syntax."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Without Webpack we lose the module polyfill that is injected per file, which potentially saves a significant size overhead, whilst staying closer to the concept of Polymer Element development."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Global JavaScript variables from external modules can be made accessible with the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"declare"}]},{type:"text",value:" placeholder, and it is still\npossible to use "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"import"}]},{type:"text",value:" to import from "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"node_modules"}]},{type:"text",value:".\nHowever, when module is set to "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"none"}]},{type:"text",value:' in the tsconfig.json, the variable will just be put onto the "global" scope. This is\nnot the '},{type:"element",tagName:"em",properties:{},children:[{type:"text",value:"true"}]},{type:"text",value:" global scope, because it is still contained within the Polymer element, so the variable will be on the Polymer\nElement scope, and should not leak to the actual global scope. "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Import"}]},{type:"text",value:" should still be used with caution: it will lead to code duplication if 2 Polymer+TypeScript elements import the\nsame dependency. In that case it would be better to import that dependency via HTML import because the Polymer compiler can deduplicate it."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Webpack can also be used to package CSS as modules, but for encapsulating CSS in Polymer the\n"},{type:"element",tagName:"a",properties:{href:"https://developer.mozilla.org/en-US/docs/Web/Web_Components/Shadow_DOM"},children:[{type:"text",value:"Shadow DOM"}]},{type:"text",value:" can be used. This is actually an\naspect of web components that is very well executed."}]},{type:"text",value:"\n"},{type:"element",tagName:"h3",properties:{id:"automatic-compilation"},children:[{type:"element",tagName:"a",properties:{href:"#automatic-compilation",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Automatic compilation"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Without Webpack, it is unpractical that for every change to a TypeScript file a manual transformation is needed. Following\nthe example in the previous section, each time "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"polygram-details.ts"}]},{type:"text",value:" changes, "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"./node_modules/.bin/tsc --target ES6 polygram-details.ts"}]},{type:"text",value:"\nmust be run. Let's try to automate this without using Webpack."}]},{type:"text",value:"\n"},{type:"element",tagName:"h4",properties:{id:"with-tsc"},children:[{type:"element",tagName:"a",properties:{href:"#with-tsc",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"With tsc"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"First I make a new tsconfig named "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"tsconfig.inline.json"}]},{type:"text",value:" for this use case:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-json"]},children:[{type:"element",tagName:"code",properties:{className:["language-json"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n  "},{type:"element",tagName:"span",properties:{className:["token","property"]},children:[{type:"text",value:'"compilerOptions"'}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","property"]},children:[{type:"text",value:'"sourceMap"'}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","boolean"]},children:[{type:"text",value:"true"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","property"]},children:[{type:"text",value:'"target"'}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"ES6"'}]},{type:"text",value:"\n  "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"\n  "},{type:"element",tagName:"span",properties:{className:["token","property"]},children:[{type:"text",value:'"include"'}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"*.ts"'}]},{type:"text",value:"\n  "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"To compile run "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"./node_modules/.bin/tsc -w -p tsconfig.inline.json"}]},{type:"text",value:". The "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"-w"}]},{type:"text",value:" flag keeps the process running and watches for\nchanges in the included TypeScript files. "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"An interesting side-effect occurs. Naturally, each TypeScript file is going to need the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"declare const Polymer: any;"}]},{type:"text",value:"\ndeclaration as a workaround for the fact that the Polymer dependency can't be imported (see previous sections). But\nbecause we now use "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"-p"}]},{type:"text",value:", the project flag, the compiler expects all files share global scope. And the second file\nusing "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"declare const Polymer: any;"}]},{type:"text",value:" will get an error: "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Cannot redeclare block-scoped variable 'Polymer'"}]},{type:"text",value:". How can we use\nthe project flag, without letting the compiler share the global scope between all TypeScript files?"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"A workaround would be to create a TypeScript file that just imports/declares all the expected global variables once.\nThis would make the code less transparent at best and it might even create other scoping issues."}]},{type:"text",value:"\n"},{type:"element",tagName:"h3",properties:{id:"custom-compilation"},children:[{type:"element",tagName:"a",properties:{href:"#custom-compilation",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Custom compilation"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"As an alternative let's try to run compilation with an isolated scope for each TypeScript file. "},{type:"element",tagName:"a",properties:{href:"https://github.com/Microsoft/TypeScript/issues/1516"},children:[{type:"text",value:"This issue"}]},{type:"text",value:"\nexplains that this would be possible by supplying a tsconfig.json for each scope. That would be doable for a limited set\nof scopes that is static over time (e.g. a back-end codebase and a front-end codebase in the same project).\nHowever, it makes no sense from a maintenance standpoint for the current project as it would need a tsconfig.json\nfor each Polymer element."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"To be complete, I did try this out. First, set up a base tsconfig that can be inherited:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-json"]},children:[{type:"element",tagName:"code",properties:{className:["language-json"]},children:[{type:"text",value:"// base.json\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n  "},{type:"element",tagName:"span",properties:{className:["token","property"]},children:[{type:"text",value:'"compilerOptions"'}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","property"]},children:[{type:"text",value:'"sourceMap"'}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","boolean"]},children:[{type:"text",value:"true"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","property"]},children:[{type:"text",value:'"target"'}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"ESNext"'}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","property"]},children:[{type:"text",value:'"moduleResolution"'}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"node"'}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","property"]},children:[{type:"text",value:'"experimentalDecorators"'}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","boolean"]},children:[{type:"text",value:"true"}]},{type:"text",value:"\n  "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Now for each Polymer TypeScript file a tsconfig, e.g.:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-json"]},children:[{type:"element",tagName:"code",properties:{className:["language-json"]},children:[{type:"text",value:"// polygram-details.tsconfig.json\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n  "},{type:"element",tagName:"span",properties:{className:["token","property"]},children:[{type:"text",value:'"extends"'}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"./base.json"'}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"\n  "},{type:"element",tagName:"span",properties:{className:["token","property"]},children:[{type:"text",value:'"files"'}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",
value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"./polygram-details.ts"'}]},{type:"text",value:"\n  "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"It is now possible to compile/watch polygram-details.ts with "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"tsc -w -p polygram-details.tsconfig.json"}]},{type:"text",value:", but it is\nstill not possible to compile/watch multiple tsconfigs at "},{type:"element",tagName:"em",properties:{},children:[{type:"text",value:"the same time"}]},{type:"text",value:"."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"In this case it would be better to forget about the watch flag "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"-w"}]},{type:"text",value:" altogether and just use "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"npm watch"}]},{type:"text",value:" combined with\n"},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"tsc [changedfile]"}]},{type:"text",value:". You can't use a tsconfig.json combined with an input file path for tsc, so all options must be\nsupplied as flags: "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"tsc --target ES6 --sourceMap [changedFile]"}]},{type:"text",value:"."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"I tried combining this compilation one-liner with a watch script, but I could not get this to work with "},{type:"element",tagName:"a",properties:{href:"https://www.npmjs.com/package/nodemon"},children:[{type:"text",value:"nodemon"}]},{type:"text",value:",\n"},{type:"element",tagName:"a",properties:{href:"https://www.npmjs.com/package/npm-watch"},children:[{type:"text",value:"npm-watch"}]},{type:"text",value:" or "},{type:"element",tagName:"a",properties:{href:"https://www.npmjs.com/package/watch"},children:[{type:"text",value:"watch"}]},{type:"text",value:", so I wrote a small script:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"code",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// ts-poly-watch.js, run with: node ts-poly-watch.js"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" watch "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"require"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'watch'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" path "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"require"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'path'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" chalk "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"require"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'chalk'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" tsc "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"require"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'node-typescript-compiler'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\nwatch"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"createMonitor"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"__dirname"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" interval"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","number"]},children:[{type:"text",value:"1"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"function"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"monitor"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n    console"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"log"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"chalk"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"gray"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"bgGreen"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"bold"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'TS-POLY-WATCH started'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n    monitor"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"on"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'changed'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"function"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"f"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" curr"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" prev"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" ext "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" path"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"extname"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"f"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"if"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"ext "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"==="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'.ts'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n            console"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"log"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"f "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"+"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"' changed'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n            tsc"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"compile"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"\n                "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n                    "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'target'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'ES6'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"\n                    "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'sourceMap'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","boolean"]},children:[{type:"text",value:"true"}]},{type:"text",value:"\n                "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:"\n                f\n            "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Now it is possible to watch each TypeScript file and compile it with its scope isolated from the other TypeScript files."}]},{type:"text",value:"\n"},{type:"element",tagName:"h2",properties:{id:"twc"},children:[{type:"element",tagName:"a",properties:{href:"#twc",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"twc"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"With "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"ts-poly-watch.js"}]},{type:"text",value:" it looks like we finally have an acceptable working environment. I have extracted the script to\nits own project "},{type:"element",tagName:"a",properties:{href:"https://github.com/mdvanes/typescript-batch-compiler"},children:[{type:"text",value:"typescript-batch-compiler"}]},{type:"text",value:" and "},{type:"element",tagName:"a",properties:{href:"https://www.npmjs.com/package/typescript-batch-compiler"},children:[{type:"text",value:"npm package"}]},{type:"text",value:" because\nthere is much room for improvement and it will be easier to use in other projects if it is an npm package."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"So are we now done? In fact there is one more thing I want to explore. During the research I ran into "},{type:"element",tagName:"a",properties:{href:"https://github.com/Draccoz/twc"},children:[{type:"text",value:"twc"}]},{type:"text",value:".\nThis is a compiler for "},{type:"element",tagName:"em",properties:{},children:[{type:"text",value:"TypeScript Web Components"}]},{type:"text",value:" and can be used to compile TypeScript classes to Polymer 2 elements.\nAlthough this sounds like it is similar to my "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"typescript-batch-compiler"}]},{type:"text",value:", here are some preliminary findings:"}]},{type:"text",value:"\n"},{type:"element",tagName:"ol",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"It assumes a TypeScript file as the entrypoint: in my setup I still stay close to the Polymer setup with a\nPolymer element (so HTML) that includes a script file. With "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"twc"}]},{type:"text",value:" the entrypoint is a TypeScript file that imports an HTML template.\nA great advantage is that this is more like Polymer 3 and also similar to other component driven frameworks\nlike React, Vue and Angular. The disadvantage is of course that the style will be foreign to other Polymer developers."}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"It's still very experimental. There is no example in the repo or an explanation of how to set up a basic element in the\nREADME, but a general approach is outlined "},{type:"element",tagName:"a",properties:{href:"https://github.com/Draccoz/twc/wiki/Creating-a-simple-component"},children:[{type:"text",value:"on the project wiki"}]},{type:"text",value:"\nand examples of twc in a project can be found in "},{type:"element",tagName:"a",properties:{href:"https://github.com/mlisook/generator-polymer-init-twc-starter-kit"},children:[{type:"text",value:"this generator project"}]},{type:"text",value:"."}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"With the aforementioned wiki, I take these steps:"}]},{type:"text",value:"\n"},{type:"element",tagName:"ul",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Run "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"twc"}]},{type:"text",value:' in a new subdir of the project appropriately named "twc"'}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Set up a very basic polygram-twc.ts conforming to the style as outlined in the wiki:"}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"code",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// polygram-twc.ts"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"import"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" CustomElement "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"from"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'twc/polymer'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"import"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'bower:polymer/polymer-element.html'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\n"},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"/**\n * `online-state`\n * Lets you select an online state (online or offline) and reflect the change on a host attribute.\n *\n * @customElement\n * @polymer\n * @demo demo/index.html\n */"}]},{type:"text",value:"\n@"},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"CustomElement"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"class"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"OnlineState"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"extends"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"Polymer"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"Element"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n    prop1"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"string"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"online-state"'}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\n    "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"template"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","template-string"]},children:[{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"`\n          <style>\n            :host {\n              display: block;\n            }\n          </style>\n          <h2>Hello [[prop1]]!</h2>\n        `"}]}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"ul",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Run "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"tsc --init"}]},{type:"text",value:" to create a new tsconfig.json in the twc dir. This turns out to be important. When I re-use my existing\ntsconfig.json the build fails with "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Error: Debug Failure."}]},{type:"text",value:". This seems to be caused by the line "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:'"moduleResolution": "node"'}]},{type:"text",value:",\nwhich is not needed for this compilation."}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Add "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"node_modules/twc/types/polymer.decorators.d.ts"}]},{type:"text",value:" to the include section of the tsconfig.json, to resolve certain types."}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Build in the twc dir by running "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"../node_modules/.bin/twc polygram-twc.ts"}]},{type:"text",value:"."}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"A polygram-twc.html is created."}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"I also converted the original polygram-details.html (the one with embedded JavaScript) to this format. See the result\nin "},{type:"element",tagName:"a",properties:{href:"https://github.com/mdvanes/polygram/tree/TypeScript/twc"},children:[{type:"text",value:"the repo for this experiment"}]},{type:"text",value:". When working on this\nconversion, some differences with normal web components become apparent:"}]},{type:"text",value:"\n"},{type:"element",tagName:"ul",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"twc auto-injects the registration of the component: "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"customElements.define(PolygramDetails.is, PolygramDetails);"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"import './polygram-ui-details';"}]},{type:"text",value:" is converted to "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:'<link rel="import" href="./polygram-ui-details.html">'}]}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"is"}]},{type:"text",value:" getter, i.e. this: "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"static get is() { return 'polygram-details'; }"}]},{type:"text",value:"\nis auto generated from the class name."}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"The JSDoc is converted to an HTML comment."}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"This syntax uses plain ES modules and is therefore also closer to Polymer 3. Still there are some differences.\nCompare the code for polygram-twc.ts but in "},{type:"element",tagName:"a",properties:{href:"https://www.polymer-project.org/blog/2017-08-23-hands-on-30-preview"},children:[{type:"text",value:"Polymer 3 syntax"}]},{type:"text",value:":"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"]},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"code",properties:{className:["language-typescript"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// PolymerElement is its own module now, instead of a property of the Polymer namespace. Also, bower is no longer used."}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]
},children:[{type:"text",value:"import"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" Element "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"as"}]},{type:"text",value:" PolymerElement "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"from"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'@polymer/polymer/polymer-element'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\n"},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// Aside from inline templates, this syntax can be used too:"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"//import * as view from './app.template.html';"}]},{type:"text",value:"\n\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"export"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"class"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"OnlineState"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"extends"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"PolymerElement"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"constructor"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"super"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// Property must be defined in the constructor, but this might be a difference with TypeScript and not Polymer 3."}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"this"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"prop1 "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'online-state'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n\n    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"static"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"get"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"template"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// I don't know where the <style> element should go."}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","template-string"]},children:[{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"`<h2>Hello [[prop1]]!</h2>`"}]}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// Or when using an import:"}]},{type:"text",value:"\n        "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"//return view;"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Although I can't find any sources, I heard that Polymer 3 would supply an auto converter from (normal) Polymer 2 syntax.\nYou could use that converter on the output of twc, so this should not be a reason to avoid twc."}]},{type:"text",value:"\n"},{type:"element",tagName:"h2",properties:{id:"final-remarks"},children:[{type:"element",tagName:"a",properties:{href:"#final-remarks",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Final remarks"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Unit testing and coverage support when using TypeScript has not been mentioned, but I hope it is clear that it is\nunchanged from a normal Polymer 2 application when using typescript-batch-compiler. You can just use\n"},{type:"element",tagName:"a",properties:{href:"https://github.com/Polymer/web-component-tester"},children:[{type:"text",value:"WCT"}]},{type:"text",value:"), because all components\nare compiled to a state that conforms to a non-TypeScript Polymer 2 situation."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"For the Webpack approach it would be an improvement to see why "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"polymer-webpack-loader"}]},{type:"text",value:" is not importing Polymer when\nusing "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"import Polymer from '../bower_components/polymer/polymer-element.html'"}]},{type:"text",value:"\nor "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"import '../bower_components/polymer/polymer-element.html'"}]},{type:"text",value:"."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"It could also be an improvement to add the "},{type:"element",tagName:"a",properties:{href:"https://www.npmjs.com/package/tslint-plugin-prettier"},children:[{type:"text",value:"prettier"}]},{type:"text",value:" plugin to promote a\nconsistent coding style. This could be added to TSLint via Webpack, but could also be integrated in the\ntypescript-batch-compiler package."}]}],data:{quirksMode:!1}},timeToRead:24,excerpt:"For  reasons beyond my control  I'm working with\nPolymer 2 at the moment. Although the idea of web components is great, the choice for HTML…",frontmatter:{title:"Polymer 2 and TypeScript",cover:"/cover/",hash:"48d58e4043f0cebc0a8a111f421b49cae3a56dc2",date:"09-12-2017",category:"webdevelopment",tags:["webdevelopment"]},fields:{nextTitle:"Site updated",nextSlug:"/site-updated",prevTitle:"Reducing cyclomatic complexity with functional operators",prevSlug:"/reducing-cyclomatic-complexity-with-functional-operators",slug:"/polymer-2-and-type-script"}}},pathContext:{slug:"/polymer-2-and-type-script"}}}});
//# sourceMappingURL=path---polymer-2-and-type-script-65589a0b2b1ae92999c0.js.map